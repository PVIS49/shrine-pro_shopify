<div id="cvs-{{ section.id }}-{{ block.id }}" class="custom-variant-selector">

  {% assign displayed_variants = product.variants | slice: 0, 3 %}

  {% for variant in displayed_variants %}
    <label class="custom-variant-selector__block{% if forloop.first %} selected{% endif %}"
       data-variant-id="{{ variant.id }}"
       data-o1="{{ variant.option1 | escape }}"
       data-o2="{{ variant.option2 | escape }}"
       data-o3="{{ variant.option3 | escape }}">

      <span class="variant-indicator"></span>
      <input type="radio" name="custom_variant_id" class="hidden-radio" value="{{ variant.id }}" {% if forloop.first %}checked{% endif %}>
      <div class="variant-card">
        {% if forloop.index == 2 %}
  <div class="variant-badge">Économisez 50€</div>
{% endif %}

    {% if variant.metafields.custom.custom_image %}
  <img
    src="{{ variant.metafields.custom.custom_image | image_url: width: 300 }}"
    alt="{{ variant.title }}"
    class="{% if forloop.index == 1 %}img-small{% else %}img-large{% endif %}">
{% elsif variant.featured_media %}
  <img
    src="{{ variant.featured_media.preview_image | image_url: width: 300 }}"
    alt="{{ variant.title }}"
    class="{% if forloop.index == 1 %}img-small{% else %}img-large{% endif %}">
{% endif %}


        <p class="variant-label">{{ variant.title }}</p>
<div class="variant-price">
  {% if variant.compare_at_price > variant.price %}
    <span class="old-price">{{ variant.compare_at_price | money }}</span>
  {% endif %}
  <span class="current-price">{{ variant.price | money }}</span>
</div>
      </div>
    </label>
  {% endfor %}
</div>

<style>
.custom-variant-selector{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr)); /* deux colonnes permanentes */
  gap:12px;
  margin-top:20px;
}
  .hidden-radio {
  display: none;
}


/* chaque carte occupe exactement sa colonne */
.custom-variant-selector__block{
  width:100%;                 /* ← la grille gère la largeur */
  box-sizing:border-box;
  border:2px solid #ccc;
  border-radius:10px;
  padding:10px;
  text-align:center;
  position:relative;
  cursor:pointer;
  transition:all .2s ease;
}
.variant-card {
  display: flex;
  flex-direction: column;
  justify-content: flex-end; /* aligne le contenu vers le bas */
  height: 150px; /* fixe une même hauteur pour toutes les cartes */
}

.variant-card img.img-small {
  height: 50px;
  object-fit: contain;
  align-self: center;
}

.variant-card img.img-large {
  height: 70px;
  object-fit: contain;
  align-self: center;
}

.custom-variant-selector__block.selected{
  border-color:#000;
  background:#f6f6f6;
}

/*  décorations inchangées  */
.variant-badge {
  position: absolute;
  top: 6px;
  left: 50%;
  transform: translateX(-50%);
  background: #1A1A1A;
  color: white;
  padding: 4px 10px;
  font-size: 12px;
  border-radius: 6px;
  white-space: nowrap;       /* empêche le retour à la ligne */
  overflow: hidden;          /* masque le débordement */
  text-overflow: ellipsis;   /* ajoute "..." si trop long */
  max-width: 90%;            /* limite la largeur */
  z-index: 2;
}
  .variant-price {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  margin-top: 4px;
  font-size: 14px;
}

.old-price {
  text-decoration: line-through;
  color: #999;
  font-size: 14px;
}

.current-price {
  font-weight: bold;
  color: #000;
}


.variant-indicator{
  width:10px;height:10px;border-radius:50%;
  border:2px solid #000;position:absolute;top:10px;right:10px;
}
.custom-variant-selector__block.selected .variant-indicator{background:#000}
/* override de position pour la pastille promo */
.custom-variant-selector .variant-badge{
  top: -10px;                 /* remonte la pastille */
  transform: translateX(-50%);/* garde le centrage horizontal */
}
/* Réduction globale ~20% des cartes variantes (override simple) */
#cvs-{{ section.id }}-{{ block.id }} .custom-variant-selector__block{
  padding: 8px;          /* était 10px */
  border-radius: 8px;    /* était 10px */
}

#cvs-{{ section.id }}-{{ block.id }} .variant-card{
  height: 120px;         /* était 150px */
}

#cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-small{
  height: 40px;          /* était 50px */
}

#cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-large{
  height: 56px;          /* était 70px */
}

#cvs-{{ section.id }}-{{ block.id }} .variant-label{
  font-size: 14px;       /* ajuste si besoin */
}

#cvs-{{ section.id }}-{{ block.id }} .variant-price{
  font-size: 12px;       /* était 14px */
  gap: 4px;              /* était 6px */
}

#cvs-{{ section.id }}-{{ block.id }} .old-price{ font-size: 12px; }

/* pastille & indicateur un poil plus petits */
#cvs-{{ section.id }}-{{ block.id }} .variant-badge{
  font-size: 11px;
  padding: 3px 8px;
}

#cvs-{{ section.id }}-{{ block.id }} .variant-indicator{
  width: 9px; height: 9px;
  top: 8px; right: 8px;
}

/* (optionnel) encore un cran de réduction en mobile */
@media (max-width: 749px){
  #cvs-{{ section.id }}-{{ block.id }} .variant-card{ height: 110px; }
  #cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-small{ height: 36px; }
  #cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-large{ height: 50px; }
}
/* ↓↓↓ fait descendre le contenu (image + textes) sans déplacer l'étiquette */
#cvs-{{ section.id }}-{{ block.id }} .variant-card{
  padding-top: 16px;      /* pousse le contenu vers le bas */
  justify-content: flex-start; /* on n’a plus besoin de “coller” en bas */
}

/* Espace plus serré entre le nom et le prix */
#cvs-{{ section.id }}-{{ block.id }} .variant-label{
  margin-top: 6px;        /* un petit air au-dessus du nom */
  margin-bottom: 2px;     /* réduit l’écart avant le prix */
  line-height: 1.2;
}
#cvs-{{ section.id }}-{{ block.id }} .variant-price{
  margin-top: 2px;        /* était 4px */
  gap: 4px;               /* était 6px */
}

/* Optionnel : un poil d’air au-dessus de l’image si besoin */
#cvs-{{ section.id }}-{{ block.id }} .variant-card img{
  display: block;
  margin-top: 4px;        /* ajuste à 0/2/6 selon rendu */
}

/* L’étiquette reste en place (ne bouge pas) */
#cvs-{{ section.id }}-{{ block.id }} .variant-badge{
  /* rien à changer ici, elle reste indépendante du padding de .variant-card */
}
/* 1) Même hauteur d’image pour toutes les cartes */
#cvs-{{ section.id }}-{{ block.id }} .variant-card img,
#cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-small,
#cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-large{
  height: 56px;        /* choisis 50–60px selon ton goût */
  object-fit: contain;
}

/* 2) Aligner image + textes en bas de chaque carte (même baseline) */
#cvs-{{ section.id }}-{{ block.id }} .variant-card{
  height: 120px;       /* ta hauteur de carte actuelle */
  padding-top: 16px;   /* garde un peu d’air pour ne pas toucher le badge */
  display: flex;
  flex-direction: column;
  justify-content: flex-end;  /* <- tout en bas, dans toutes les cartes */
}

/* 3) Espacements compacts et constants */
#cvs-{{ section.id }}-{{ block.id }} .variant-label{
  margin-top: 6px;
  margin-bottom: 2px;
  line-height: 1.2;
}
#cvs-{{ section.id }}-{{ block.id }} .variant-price{
  margin-top: 2px;
  gap: 4px;
  line-height: 1;      /* évite des variations verticales */
}
/* Zone image fixe + alignement bas des textes */
#cvs-{{ section.id }}-{{ block.id }} .variant-card{
  display: grid;
  grid-template-rows: 72px auto auto;  /* 72px = case réservée pour l'image */
  justify-items: center;
  align-content: end;                   /* nom + prix alignés en bas */
  height: 120px;                        /* ta hauteur de carte */
  padding-top: 16px;                    /* laisse de la place sous le badge */
}

/* Tailles différenciées */
#cvs-{{ section.id }}-{{ block.id }} .variant-card img{
  object-fit: contain;
  align-self: center;                   /* centre dans la case de 72px */
}

/* 50 ml = plus petit */
#cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-small{
  height: 44px;                         /* ajuste 40–48px si besoin */
}

/* 100 ml = plus grand */
#cvs-{{ section.id }}-{{ block.id }} .variant-card img.img-large{
  height: 60px;                         /* ajuste 56–64px si besoin */
}

/* Espaces compacts et constants (si pas déjà fait) */
#cvs-{{ section.id }}-{{ block.id }} .variant-label{ margin-top:6px; margin-bottom:2px; line-height:1.2; }
#cvs-{{ section.id }}-{{ block.id }} .variant-price{ margin-top:2px; gap:4px; line-height:1; }

</style>